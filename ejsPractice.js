const express = require("express");
const path = require("path");
const helmet = require("helmet");

const server = express();

server.listen(3000);

// basic security
server.use(helmet());

// serve up static files
server.use(express.static('public'));
// parse json and urlencoded data into req.body
server.use(express.json());
server.use(express.urlencoded({extended: true}));

server.set("view engine", "ejs");
server.set("views", path.join(__dirname, "views", "ejs"));

function validateUser(req, res, next) {
  //todo: validation logic
  res.locals.validated = true;
  next();
}

server.use(validateUser);

server.get('/', (req, res, next) => {
  // the data in the second arg is going to be appended to res.locals
  res.render("index", {
    msg: "Success",
    html: "<p><img src='data:image/jpeg;base64,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'</p>"
  });
});
